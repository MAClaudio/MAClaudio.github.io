<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Capofier</title>
<script TYPE="TEXT/JAVASCRIPT">
function capofy()
{
var tab = document.getElementById("comments");
var shift = document.getElementById("capo").value;
var tab_string = tab.value;
var note;
var newNote;
var newTab = "";
// Retain tab formatting
tab_string = tab_string.replace(/ /g, '&nbsp;');
tab_string = tab_string.replace(/\r?\n/g, '<br />');

for (var i = 0; i < tab_string.length; i++)
{
  note = parseInt(tab_string[i]);
  nextNote = parseInt(tab_string[i+1]);

  // If fret is 2 digits, concat into 1 number and skip next char
  if(note >= 0 && note <= 9 && nextNote >= 0 && nextNote <= 9)
  {
    note = parseInt(tab_string[i] + tab_string[i+1]);
    i = i + 1;
  }
  if(note >= 0 && note <= 30)
  {
    // Shift note by capo amount.
    newNote = ((note) + parseInt(shift))
    // Add new fret to tab
    newTab += newNote;
    // If new note is double digits, skip the next - symbol
    if(note < 10 && newNote >9)
      i = i + 1;
  }
  else
  {
    newTab += tab_string[i];
  }
}
document.write("<pre>" + newTab + "</pre>");

}
</script>
</head>

<body>
  <form name="tab" id="tab" method="get" action="submit">
  Select Capo Fret:
  <select id="capo">
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
  <option value="5">5</option>
  <option value="6">6</option>
  <option value="7">7</option>
  <option value="8">8</option>
  <option value="9">9</option>
  <option value="10">10</option>
  <option value="11">11</option>
  <option value="12">12</option>
  </select>
  <input type="submit" value="Submit" onclick="capofy();" style="background-color:black;color:white;padding:5px;font-size:18px;border:none;padding:8px;">
  </form>

  <textarea rows="50" id="comments" cols="130" name="comments" form="tab" placeholder="Paste Tab Here..."></textarea>
</body>
</html>
